import { JsonProof, verify } from "o1js";

const verificationKey = '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'

export async function verifyProof(proof: JsonProof) {
  return verify(proof, verificationKey)
}

export async function verify2048Proof(proof: JsonProof): Promise<[string, number]> {
  if (!await verifyProof(proof)) return ['', -1];

  let result = 0;
  for (let i = 0; i < 16; i++) {
    result = Math.max(result, parseInt(proof.publicInput[i]))
  }
  return [proof.publicInput[16], result];
}